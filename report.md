# Численное исследование уравненения Бонгоффера – Ван дер Поля.

## Оглавление

[Постановка задачи](#1)
[Методы решения](#2)
[Проверка корректности методов](#3)
[Применение методов к поставленной задаче, анализ результатов](#4)

<a id="1"></a>

## Постановка задачи

**Дано**:

$$
    \begin{cases}
    x' = -a(\frac{x^3}{3} - x) + ay,\\
    y' = -x - by + c,\\
    x(0) = 2,\quad y(0) = 0
    \end{cases}
$$

Здесь 1 $\leq$ _a_ $\leq$ $10^3$, 0 < _c_ < 1.

**Задача**:
Провести исследование поведения решений в зависимости от значений «большого» параметра _a_.

<a id="2"></a>

## Методы решения

Для поиска первообразных было выбрано пять численных метода: _явный метод Эйлера_, _явный метод Рунге-Кутты 4го и 5го порядка_, _неявный метод эйлера 1го порядка_ и _неявный метод Рунге-Кутты 4го порядка_.

### Явный метод Эйлера

Имеем отрезок времени $[T_{0}, T_{\mathrm{fin}}]$. Разобьем его точками $t_{0}, 
t_{1}, \ldots, t_{\mathrm{n}}$, где $t_{1}=T_{0}$ и $t_{n}=T_{\mathrm{fin}}$.
$\mathrm \tau_{i} = t_{i} - t_{i-1}$
Для каждой $i$-ой точки найдем ($x_{\mathrm{i}}$, $y_{\mathrm{i}}$) ($\mathrm 0 
\leqslant i \leqslant n$). Имеем $$ \frac{x*{i} - x*{i-1}}{\tau*{i}}=x(x*{i-1},
y*{i-1}) \quad \text{и} \quad \frac{y*{i} - y*{i-1}}{\tau*{i}}=y(x*{i-1},
y*{i-1}) \quad (1 \leqslant i \leqslant n)$$ Получим уравнения:

$$
\mathrm
    x_{i} = \begin{cases} x_{0}&\text{, при i = 0}\\
    x(x_{i-1},y_{i-1})\tau_{i}+x_{i-1}&\text{, иначе} \end{cases}
$$

и

$$
\mathrm
    y_{i} = \begin{cases} y_{0}&\text{, при i = 0}\\
    y(x_{i-1},y_{i-1})\tau_{i}+y_{i-1}&\text{, иначе} \end{cases}
$$

Применение его к данной задаче:

$$
\mathrm
    x_{i} = \begin{cases} 2 &\text{, при i = 0}\\
    (-a(\frac{x_{i-1}^3}{3} - x_{i-1}) + ay_{i-1})\tau_{i}+x_{i-1}&\text{, иначе} \end{cases}
$$

и

$$
\mathrm
    y_{i} = \begin{cases} 0 &\text{, при i = 0}\\
    (-x_{i-1} - by_{i-1} + c)\tau_{i}+y_{i-1}&\text{, иначе} \end{cases}
$$

По этим значениям и будем строить график.

### Неявный метод Эйлера

Отличается от явного метода Эйлера тем, что мы получаем систему уравнений:

$$
    \begin{cases}
    x_{i} = x(x_{i},y_{i})\tau_{i}+x_{i-1} \\
    y_{i} = y(x_{i},y_{i})\tau_{i}+x_{i-1} \\
    \end{cases}
$$

Применений к нашей задаче:

$$
    \begin{cases}
    x_{i} = (-a(\frac{x_{i}^3}{3} - x_{i}) + ay_{i})\tau_{i}+x_{i} \\
    y_{i} = (-x_{i} - by_{i} + c)\tau_{i}+y_{i} \\
    \end{cases}
$$

Будем численно искать решение этой системы с помощью метода Ньютона. С помощью
него будем искать $x_{i}$. Рассмотрим функцию  
$f(x_{i}) = -x_{i} + (-a(\frac{x_{i}^3}{3} - x_{i}) + ay_{i})\tau_{i}+x_{i} = 0$.
Суть метода ньютона найти такое $\tilde x_{n}$, такую что $f(\tilde x_{n}) 
\approx 0$, где $\mathrm n$ - число итераций алгоритма, а $\tilde x_{n}$ - точка
приближения. Зададим начальную точку приближения $\tilde x_{0} = x_{i - 1}$.

$$
\tilde x_{i} = \tilde x_{i - 1} -
\frac{f(\tilde x_{i - 1})}{f'(\tilde x_{i - 1})} (1 \leqslant i \leqslant n)
$$

Таким образом находим n-ую точку приближения и считаем, что она равна $x_{i}$.
Чем больше итераций будет сделано, тем ближе эта точка будет к настоящему решению, но
делать их слишком много тоже не имеет смысла.  
После того, как мы найдем таким образом $x_{i}$ подставляем ее в уравнение для
$y_{i}$. Так мы получаем точки $(x_{i}, y_{i})$, по ним и строим график.

### Метод Рунге-Кутты 4-го порядка

Метод Рунге-Кутты 4-го порядка - явный одношаговый метод. Точность возрастает за счет дополнительных вычислений на отрезке $[t_n, t_n + T]$.
Если положить $\frac{dy}{dt} = f(t, y)$, где t - независимая переменная, то алгоритм выглядит так:

\begin{equation}
\begin{split}
&k*1 = f(t_n, y_n), \\
&k_2 = f(t_n + \frac{T}{2}, y_n + \frac{T}{2}k1), \\
&k_3 = f(t_n + \frac{T}{2}, y_n + \frac{T}{2}k2), \\
&k_4 = f(t_n + T, y_n + Tk3) \\
&\text{тогда следующее значение $y(t)$ считается по формуле:} \\
&y*{n+1}=y_n + \frac{T}{6}(k_1+2k_2+2k_3+k_4)
\end{split}
\end{equation}

В поставленной задаче три переменных, поэтому если взять $\frac{dx}{dt} = f_x(t, x, y)$ и $\frac{dy}{dt} = f_y(t, x, y)$ метод примет вид

\begin{equation}
\begin{split}
&k*{x1} = f(t_n, y_n, x_n), \\
&k*{y1} = f(t*n, y_n, x_n), \\
&k*{x2} = f(t*n + \frac{T}{2}, y_n + \frac{T}{2}k1), \\
&k*{x3} = f(t*n + \frac{T}{2}, y_n + \frac{T}{2}k2), \\
&k*{x4} = f(t*n + T, y_n + Tk3), \\
&y*{n+1}=y_n + \frac{T}{6}(k_1+2k_2+2k_3+k_4)
\end{split}
\end{equation}

### Метод Рунге-Кутты-Фельберга 5-го порядка

Таблица Бутчера семейства явных методов Рунге-Кутты имеет диагональный вид, то есть не требует решения системы уравнений. Поэтому несложно было реализовать и метод 5го порядка.

### Динамический шаг

### Неявный метод 4-го порядка

<a id="3"></a>

### Проверка корректности методов

#### 1ая тестовая задача (не жесткая)

Для задачи

$$
x=y
$$

Численные методы показывают следующую погрешность

Явный метод Эйлера...

#### 2ая тестовая задача (жесткая)

В качестве тестовой задачи мы

Для жесткой задачи оказалось, что явные методы крайне неустойчивы и все имеют погрешность = 1
И чем больше показатель жесткости, тем хуже ситуация

Вывод: анализ задачи лучше производить с помощью неявного метода

<a id="4"></a>

### Применение методов к поставленной задаче, анализ результатов

Сравним график x от t полученный методами явного 5го порядка и неявного 1го - получим одно и то же, как для прошлой задачи
В качестве проверки приведем графики модуля SciPy

В связи со сказанным выше исследования проведем с помощью неявного метода Эйлера
